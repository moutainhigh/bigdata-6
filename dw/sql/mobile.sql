create table dw_qlml.mobile201706(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201705(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201704(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201703(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201702(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201701(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201601(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201602(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201603(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201604(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201605(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201606(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201607(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201608(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201609(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201610(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201611(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile201612(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile2016ago(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table dw_qlml.mobile_tmp(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appNames string,qqNumbers string,weixinNumbers string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';



sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201705/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201705/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201704/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201704/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201703/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201703/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201702/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201702/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201701/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201701/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201612/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201612/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201611/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201611/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201610/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201610/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201609/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201609/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201608/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201608/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201607/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201607/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201606/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201606/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201605/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201605/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201604/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201604/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201603/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201603/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201602/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201602/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-201601/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile201601/
sudo -u hive hadoop dfs -cp /datahouse/ods/mongo/mobile_deal/mobile-2016ago/part-00000.snappy /user/hive/warehouse/dw_qlml.db/mobile2016ago/


#新增字段

ALTER TABLE mongo.pq_mobile ADD COLUMNS (android_id string,pt string,phone_brand string,ram string,rom string,cpu string,lcd string,wifitime string,sen string,ac string,fromChannel string,record_time string);

create table dw_qlml.mobile_tmp(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appName string,qqNumbers string,weixinNumbers string,android_id string,pt string,phone_brand string,ram string,rom string,cpu string,lcd string,wifitime string,sen string,ac string,fromChannel string,record_time string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';


-- =========================================================================================================
create table dw_qlml.mobile_appnames_tmp(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appName string,qqNumbers string,weixinNumbers string,android_id string,pt string,phone_brand string,ram string,rom string,cpu string,lcd string,wifitime string,sen string,ac string,fromChannel string,record_time string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

create table mongo.pq_mobile_appnames(user_id string,addtime string,phone_name string,phone_number string,phone_os string,phone_model string,phone_ip string,phone_user_info string,querytime string,device_id string,device_id_type string,mac string,idfa string,imei string,imsi string,add_product string,add_channel string,networktype string,type string,ip string,version string,phone_time string,photos string,appName string,qqNumbers string,weixinNumbers string,android_id string,pt string,phone_brand string,ram string,rom string,cpu string,lcd string,wifitime string,sen string,ac string,fromChannel string,record_time string)
COMMENT 'pq_mobile_appnames parquet file'
PARTITIONED BY(cal_dt STRING)
CLUSTERED BY(user_id)  INTO 32 BUCKETS
STORED AS PARQUET;

-- ===================
create table mongo.pq_mobile_aqp(user_id string,device_id string,type string,photo_name string,photo_number string,qqnumber string,appname string,addtime string)
COMMENT 'pq_mobile_appnames parquet file'
PARTITIONED BY(dt STRING)
CLUSTERED BY(user_id)  INTO 32 BUCKETS
STORED AS PARQUET;

create table dw_qlml.mobile_appnames_tmp(user_id string,device_id string,type string,photo_name string,photo_number string,qqnumber string,appname string,addtime string)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '`';

